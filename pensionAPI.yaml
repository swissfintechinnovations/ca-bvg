openapi: 3.1.0
info:
  version: 0.8.0
  title: Pension
  # yamllint disable rule:indentiation
  description: |
    # Pension-API (Deutsch)

    **** Deutsch (for English see below) ****

    Mit dem Pension-API können Daten zur versicherten Person und deren Vorsorgesituation abgefragt werden.
    Dies umfasst vereinfacht gesagt die Daten, die auf dem Versicherungsausweis zu finden sind.
    Auch die Erstellung bzw. das Beziehen von bereits erstellten Versicherungsausweisen als PDF-Datei
    ist möglich. Des Weiteren gibt es Endpunkte zum Einkaufsprozess, für Simulationen und für Transaktionen.

    Als Einstieg fürs Pension-API wird eine technische Personen- oder Policen-ID benötigt.
    Dies wird vom Consent API geliefert.

    Die wesentlichen Objekte dieses APIs sind *Person*, *Police* und *Vorsorgeausweis*. Person bezieht sich
    immer auf eine natürliche Person, die bei einer Pensionskasse versichert ist.

    Die Police beschreibt den indirekten Versicherungsvertrag zwischen der versicherten Person
    (ArbeitnehmerIn) und der Pensionskasse. Ist eine Person über zwei Vorsorgepläne versichert,
    z.B. über einen Basis- und einen zusätzlichen Kaderplan, so hat sie zwei Policen.

    Der Vorsorgeausweis entspricht dem Dokument, welches traditionell anfangs Jahr durch die Pensionskasse
    für die Versicherten ausgestellt wird.

    Wo es relevant ist, Angaben in den obligatorischen und den über-obligatorischen Teil
    aufzutrennen, wird jeweils das Total (obligatorisch plus über-obligatorisch) und der
    obligatorische Wert separat ausgewiesen. Falls der über-obligatorische Wert benötigt wird, muss
    er vom API-Konsumenten selbst berechnet werden (Differenz zwischen den beiden Werten).

    Ausgenommen davon sind Zinssätze und Umwandlungssätze. Hier werden entweder der obligatorische
    und der über-obligatorische Satz als zwei separate Werte geliefert, oder dann wird der
    umhüllende Satz geliefert.

    Das API umfasst auch die Simulation einer Änderung des Beschäftigtengrads und/oder Lohns. Die
    Simulation berechnet die Effekte auf die monatlichen Beiträge sowie auf die voraussichtlichen
    Rentenleistungen bei unterschiedlichem Penionierungsalter.

    Das Einkaufsendpunkte erlauben es, die Auswirkungen eines freiwilligen Einkaufs in die Pensionskasse
    zu simulieren und einen Einkauf zu starten.

    Die in dieser Spezifikation angegebenen URLs sind nur Beispiel-URLs. Das API wird von einer
    Vielzahl von Pensionskassen implementiert und jede Pensionskasse hat eine andere Basis-URL
    für das API. Die Basis-URL der jeweiligen Pensionskasse wird vom Directory API geliefert.


    ## Einkaufsprozess

    Für einen freiwilligen Einkauf gelten eine Reihe von gesetzlichen Voraussetzungen, die erfüllt
    sein müssen, z.B. dass WEF-Vorbezüge zurückgezahlt wurden. Deshalb besteht der Einkaufsprozess grob aus zwei Phasen:

    - Prüfung: In dieser Phase wird der Antrag geprüft und bei Bedarf weitere Unterlagen von der versicherten Person eingefordert.

    - Zahlung: Ist der Antrag bewilligt, so macht die versicherte Person eine oder mehrere Zahlungen.


    ## Einkaufsantrag

    Beim Einkaufsprozess wird im ersten Schritt ein Einkaufsantrag erstellt. Er repräsentiert den nach aussen
    sichtbaren Stand der Prozessinstanz. Der interne Prozess unterscheidet sich von Pensionskasse zu Pensionskasse
    und besteht aus viel mehr Schritten als von aussen sichtbar. Der Antrag kann folgende Zustände haben, die für
    die versicherte Person und im API sichtbar sind:

    - In Prüfung: Die Pensionskasse ist dabei, den Antrag zu prüfen. Dies ist der erste Zustand eines neuen Antrags.

    - Unterlagen erforderlich: Die Prüfung hat ergeben, dass die versicherte Person weitere Unterlagen einreichen oder
    direkt mit der Pensionskasse Kontakt aufnehmen muss.

    - Abgelehnt: Der Einkaufsantrag wurde abgelehnt. Dies ist ein Endzustand.

    - Bewilligt: Der Einkaufsantrag wurde bewilligt. Die versicherte Person kann nun die Zahlungen vornehmen
    (einmalige oder wiederkehrende).

    - Abgeschlossen: Der Einkaufsantrag ist abgeschlossen. Eine oder mehrere Zahlungen sind erfolgt, und es sind keine
    weiteren Zahlungen mehr möglich. Dies ist ein Endzustand.

    Der Antrag kann über das API abgefragt werden und hat neben dem Antragszustand noch viele weitere Attribute,
    z.B. die bewilligte Einkaufssumme, die Summe der erfolgten Zahlungen etc.


    ## Fragen im Einkaufsantrag

    Die Einkaufsprüfung ist massgeblich durch gesetzliche Regelungen bestimmt. Dennoch gibt es Unterschiede zwischen den
    Pensionskassen. Einige stellen mehr und präzisere Fragen, andere stellen weniger Fragen und fordern schneller nach
    zusätzlichen Dokumenten oder Kontaktaufnahme.

    Das API deckt dies ab, indem die Pensionskasse bestimmen kann, ob gewisse Fragen überhaupt gestellt werden. Diese
    Fragen sind in der Tabelle unten als Optional markiert. Optionale Fragen sind optional für die Pensionskasse. Wird
    die Frage angezeigt, muss die versicherte Person sie beantworten. Optionale Fragen können auch benutzt werden, um
    die Fragen für die versicherte Person zu individualisieren. So kann darauf verzichtet werden, nach laufenden Renten
    zu fragen, wenn die Person noch nicht 55 Jahre alt ist.

    Einige Fragen hängen von anderen Fragen ab, d.h. die Fragen sind nur zu beantworten, falls bei einer anderen Frage
    eine bestimmte Antwort gegeben wurde. Diese Abhängigkeiten sind in der Tabelle unten erwähnt.

    Bei einigen Fragen kann die Pensionskasse einen Wert vorgeben, z.B. eine bereits bekannte Emailadresse. Dieser Wert
    wird in das Antwortfeld eingefüllt und kann von der versicherten Person bei Bedarf geändert werden.

    | Nr. | Frage | Typ der Antwort | Bemerkungen |
    | --- | ----- | --------------- | ----------- |
    | 1   | **Betrag** | | |
    | 1a  | Welchen Betrag möchten Sie in die Pensionskasse einzahlen? | Betrag |  |
    | 2   | **Freizügigkeitskonten oder -policen** | | |
    | 2a  | Verfügen Sie über Guthaben auf Freizügigkeitskonten bei Banken, bei der Stiftung Auffangeinrichtungen oder auf Freizügigkeitspolicen? | Ja/Nein | |
    | 3   | **Selbständige Erwerbstätigkeit** | | |
    | 3a  | Waren Sie in der Vergangenheit je selbständig erwerbstätig und haben während dieser Zeit Beiträge zugunsten der Säule 3a einbezahlt? | Ja/Nein | |
    | 3b  | Wie hoch ist das Guthaben per 31.12. des letzten Jahrs? | Betrag | Optional. Nur fragen, falls Antwort auf Frage 3a “Ja” ist. |
    | 4   | **Wohneigentum** | | |
    | 4a  | Haben Sie bei früheren Pensionskassen oder von Freizügigkeitskonten/-policen Vorbezüge getätigt und diese noch nicht vollständig zurückbezahlt? | Ja/Nein | |
    | 5   | **Zuzug aus dem Ausland** | | |
    | 5a  | Sind Sie innerhalb der letzten 5 Jahre aus dem Ausland zugezogen? (gilt auch für Schweizer Staatsangehörige) | Ja/Nein | Optional. |
    | 5b  | Wann sind Sie zugezogen? | Datum | Optional. Nur fragen, falls Antwort auf Frage 5a “Ja” ist. |
    | 5c  | Waren Sie davor bereits bei einer Schweizer Vorsorgeeinrichtung versichert? | Ja/Nein | Optional. Nur fragen, falls Antwort auf Frage 5a “Ja” ist. |
    | 5d  | Wann sind Sie zum ersten Mal einer Schweizer Vorsorgeeinrichtung beigetreten? | Datum | Optional. Nur fragen, falls Antwort auf Frage 5a “Ja” ist. |
    | 6   | **Bezug Altersrente / Kapitalauszahlung** | | |
    | 6a  | Beziehen Sie von einer Pensionskasse eine Altersrente oder haben Sie sich bereits Alterskapital auszahlen lassen? | Ja/Nein | Optional. |
    | 7   | **Weitere Fragen zur Situation** | | |
    | 7a  | Sind Sie zusätzlich bei einer anderen Vorsorgeversicherung versichert? | Ja/Nein | Optional. |
    | 7b  | Sind Sie zu 100% arbeitsfähig? | Ja/Nein | Optional. |
    | 7c  | Handelt es sich beim Einkauf um einen Wiedereinkauf nach Ehescheidung oder nach gerichtlicher Auflösung einer eingetragenen Partnerschaft? | Ja/Nein | Optional. |
    | 7d  | Wird der Einkauf mit Geld aus der Säule 3a getätigt? | Ja/Nein | Optional. |
    | 8   | **Kontaktangaben** | | |
    | 8a  | Ist Ihre Adresse <adresse> korrekt? | Ja/Nein | Optional. Die Adresse wird von der Pensionskasse geliefert und muss im Text oder separat angezeigt werden. |
    | 8b  | Unter welcher Telefonnummer dürfen wir Sie bei Fragen kontaktieren? | Telefonnummer | Optional. |
    | 8c  | Über welche Emailadresse dürfen wir Sie bei Fragen kontaktieren? | Emailadresse | Optional. |


    ## Instruktionen an die versicherte Person

    Ergibt die Prüfung, dass weitere Unterlagen oder eine Kontaktaufnahme mit der Pensionskasse nötig sind, so können der
    versicherten Person entsprechende Instruktionen erteilt werden. Diese können von der Pensionskasse frei formuliert werden.

    Die Instruktionen bestehen aus einer Liste von Sätzen. Diese werden von der Applikation als unnummerierte Liste angezeigt, z.B:

    - *Der Einkaufsbetrag reduziert sich um die Höhe des Guthabens auf den Freizügigkeitskonti / -policen. Bitte senden Sie uns
    Kopien von Konto-/Policienauszügen, die den Stand per Ende letzten Jahres zeigen.*
    - *Senden Sie die Dokumente an: Personalfürsorge der Firma Heierli AG, Bahnhofstrasse 13, 9000 St. Gallen.*
    - *Alternativ können Sie die Dokumente an einkauf@heierli-pk.ch senden. Bitte beachten Sie, dass Emails einen Weg über Server
    im Ausland nehmen können und die Vertraulichkeit auf dem Weg nicht gewährt ist.*

    Sind weitere Unterlagen nötig, so müssen diese direkt an die Pensionskasse (und nicht über die Applikation) eingereicht werden.
    Entsprechend gibt es kein API dafür.


    ## Feedback an die versicherte Person

    In vielen Fällen ist die Antragsprüfung nicht automatisiert und sofort erledigt. Stattdessen dauert sie Stunden oder sogar einige
    Tage. Wenn das Ergebnis vorliegt, sollte der/die AntragsstellerIn benachrichtigt werden. Dazu nutzt die Pensionskasse direkte
    Kommunikationskanäle (Email, SMS, Telefonanruf etc.)

    Hat die App einen eigenen Kommunikationskanal mit der versicherten Person, so kann sie regelmässig prüfen, ob sich der Status des
    Antrags verändert hat und bei einer Änderung benachrichtigen. Dieser Kanal ist freiwillig und zusätzlich zur direkten Kommunikation
    zwischen Pensionskasse und versicherter Person.


    ## Zahlungen

    Wurde der Einkauf über einen bestimmten Betrag bewilligt, so kann der Betrag wie folgt überwiesen werden:

    - **Einmalige Einzahlung mit Einzahlungsschein (QR-Rechnung)**: Die Pensionskasse stellt die Zahlungsdaten (Adresse, Kontonummer,
    Referenznummer etc.) aus, die per API an die Applikation geliefert werden.

    - **Einmalige Einzahlung über eBill**: Die Pensionskasse sendet eine eBill ans eBill-Konto der versicherten Person.

    - **Regelmässige Einzahlungen per eBill**: Es wird ein Zahlungsrhythmus vereinbart, gemäss dem die Pensionskasse eBills ans
    eBill-Konto der versicherten Person sendet.

    - **Unregelmässige Einzahlungen per Einzahlungsschein (QR-Rechnung)**: Die Pensionskasse stellt die Zahlungsdaten (Adresse,
    Kontonummer, Referenznummer etc.) aus, die die Applikation nutzt, um Zahlungen auszulösen, z.B. über eine E-Banking-Schnittstelle.
    Es wird für alle Zahlungen die gleiche Referenznummer verwendet.

    Eine Pensionskasse muss nicht alle vier Zahlungsmethoden unterstützen. Die unterstützen Zahlungsmethoden können über das API
    abgefragt werden.


    ## Simulation

    Die Simulation berechnet, wie hoch das Altersguthaben und die Rente mit und ohne Einkauf sein wird. Dabei können verschiedene Parameter gewählt werden:

    - Einkaufssumme (gesamt)
    - Pensionierungsalter
    - Betrag pro Zahlung (bei mehreren Zahlungen)
    - Zahlungsperiodizität (bei mehreren Zahlungen)
    - Datum der (ersten) Zahlung

    Die Simulation geht davon aus, dass die gesetzlichen Voraussetzungen für den Einkauf gegeben sind. Sie prüft,
    dass der maximale Einkaufsbetrag nicht überschritten wird, und passt in bei Bedarf an.


    ## Kontobewegung

    Das Kontobewegungsendpunkte liefert die Kontobewegungen des Altersguthabens einer Police.


    # Pension API (English)

    **** English (für Deutsch siehe weiter oben) ****

    The Pension API serves to query details about the insured person and their pension situation.
    In simplified terms, this includes the data found on the insurance certificate.
    Additionally, policy statements can be generated or already generated statements can be
    retrieved as PDF files. There are also endpoints for the purchasing process, for simulations
    and for transactions.

    Person and policy IDs serve as the entry point for this API. They are provided by the
    Consent API.

    The main objects are *person*, *policy* and *statement*. A person refers to a natural person
    insured with a pension fund.

    A policy describes the indirect contractural relationship between the insured person
    (employee) and the pension fund. If a person is insured by two separate insurance plans,
    e.g. a basic and a supplementary executive plan, the person has two separate plans.

    The pension certificate corresponds to the document that is traditionally issued to the
    insured persons by the pension fund at the beginning of the year.

    If it is relevant to distinguish between the mandatory and the supplementary insurance
    coverage, a total value (mandatory and supplementary values combined) and a mandatory
    coverage value are provided seperately. If the value for the supplementary coverage is
    required, the API consumer must calculate it (difference between the two values).

    Interest and conversion rates are the exception to this rule. The pension fund either
    provides two separate values for the mandatory and the supplementary part, or  they
    provide a single enveloping value.

    The API also includes the simulation of a change of employment level and/or salary. It
    calculates the effects on the monthly contributions as well as the effects of the
    perspective pension benefits for different retirement ages.

    The Purchases endpoints can simulate the prospective effects of voluntary purchases of retirement
    benefits and initiate a purchase.

    The URLs in the specification are examples only. The API is implemented by a many
    pension funds and each pension fund has an individual base URL for the API.
    The base URL of a specific pension fund is provided by the directory API.


    ## Purchase Process

    In order to make a voluntary purchase a number of legal requirements must be fulfilled, e.g. early withdrawal of savings
    must have been paid back. Thus the purchase process consists of two phases:

    - Validation: In the first phase, the purchase application is validated and - if needed - additional documentation is requests from the insured person.

    - Payment: Once the application has been approved, the insured person makes one or several payments.


    ## Purchase Application

    The initial step of the purchase process is to create an application. It represent the externally visible state
    of the process instance. The internal process differs from pension fund to pension fund and likely consists
    of far more steps than are externally visible. The application can have the below states that are visible
    for the insured person and in the API:

    - In review: The pension fund is reviewing and validating the application. This is the initial state of a new application.

    - Input required: The validation requires the the insured person provides additional documents or contacts the pension fund directly.

    - Rejected: The application has been rejected. This is a final state.

    - Approved: The purchase application was approved. The insured person can now make payments (once or repeating).

    - Completed: The purchase application has been completed. One or more payments have been received, and no further payments
    are possible. This is a final state.

    The application can be queried using the API. It will return the application state and many additional attributes,
    such as the approved purchase amount, the amount of received payments.


    ## Purchase Questionnaire

    The purchase application validation is mainly governed by legal regulation. Nevertheless, there are differences between
    the pension funds. Some funds ask many precise questions while other funds ask few questions and quickly resort
    to requesting additional documents or direct contact.

    The API covers these differences as the pension fund can decide if certain questions are asked at all. These questions
    are marked as optional in the below table. Optional questions are optional for the pension fund. If the questions is
    displayed to the insured person, it must be answered. Optional questions can also be used to tailor the questionnaire
    to the insured person, e.g. by not asking whether the person is already drawing a pension if he/she is younger than 55.

    Some questions depend on the answer of other question, i.e. the question is only relevant if a certain answer has been
    given to a previous question. Such dependencies are mentioned in the below table.

    For certain questions, the pension fund can provide an initial value, e.g. an earlier provided email address. The answer field
    will be prefilled with this value and the insured person can change it if needed.

    | No  | Question | Answer type | Remark |
    | --- | ----- | --------------- | ----------- |
    | 1   | **Amount** | | |
    | 1a  | What amount of payment would you like to make towards the pension fund? | Amount |  |
    | 2   | **Pillar 2 Vested Benefits** | | |
    | 2a  | Do you have any additional pillar 2 claims from vested benefits accounts, vested benefits policies or at the Foundation of the BVG Contingency Fund? | Yes/No | |
    | 3   | **Self-employment** | | |
    | 3a  | Have you ever been self-employed and paid into pillar 3a during that time? | Yes/No | |
    | 3b  | What is the pillar 3a balance as of 31 December of last year? | Amount | Optional. Will only be asked if the answer for question 3a is 'Yes'. |
    | 4   | **Residental property** | | |
    | 4a  | Have you made an early withdrawal of pension savings to fund the purchase of residential property and have not fully paid it back? | Yes/No | |
    | 5   | **Move to Switzerland** | | |
    | 5a  | Have you moved to Switzerland from another country during the last 5 years? (applies to Swiss citizens as well) | Yes/No | Optional. |
    | 5b  | When have you moved to Switzerland? | Date | Optional. Will only be asked if answer to question 5a is 'Yes'. |
    | 5c  | Have you ever joined a Swiss pillar 2 pension plan before? | Yes/No | Optional. Will only be asked if answer to question 5a is 'Yes'. |
    | 5d  | When have you joined a Swiss pillar 2 pension plan for the first time? | Date | Optional. Will only be asked if answer to question 5a is 'Yes'. |
    | 6   | **Early retirement pension / savings capital withdrawal** | | |
    | 6a  | Are you drawing a retirement pension or have you ever withdrawn retirement savings capital from a pension fund? | Yes/No | Optional. |
    | 7   | **Additional question regarding the insured person** | | |
    | 7a  | Are you currently insured in an additional pension plan? | Yes/No | Optional. |
    | 7b  | Are you fully able for work? | Yes/No | Optional. |
    | 7c  | Is the purchase made to make up for the pension savings surrender due to a divorce or a dissolution of a civil partnership?? | Yes/No | Optional. |
    | 7d  | Is the purchase made with money originating from a pillar 3a account? | Yes/No | Optional. |
    | 8   | **Contact** | | |
    | 8a  | Is your address <adresse> correct? | Yes/No | Optional. The address will be provided by the pension fund and must be displayed in the question text or nearby on the screen. |
    | 8b  | What is your phone number to contact you in case of questions? | Phone number | Optional. |
    | 8c  | What is your email address to contact you in case of questions? | Email address | Optional. |


    ## Instructions for the Insured Person

    If the result of the initial review is that additional documents or direct contact with the pension fund is needed,
    such instructions can be given to the insured person. The pension fund can phrase the instructions according to their needs.

    Structurally, the instructions are a list of sentences. The application will display them as bullet list, e.g.:

    - *Your purchasing potential will be reduced by your further claims from pillar 2 (vested benefits account or policy). Please
    send us a copy of the current account statement for your vested benefit accounts.*
    - *Please send the documents to: Personalfürsorge der Firma Heierli AG, Bahnhofstrasse 13, 9000 St. Gallen.*
    - *Alternatively, you can send the documents to einkauf@heierli-pk.ch. Please not that emails can take a route via servers abroad,
    and confidentially on this path cannot be guaranteed.*

    If additional documents are required for the purchase, they must be sent directly to the pension fund (and not via the application).
    Thus, there is no API to upload documents.


    ## Feedback to the Insured Person

    In many cases, the application validation is not fully automated and not immediately done. Instead, it can last hours or even days.
    Once the result is ready, the insured person should be notified. The pension fund uses direct communication channels (email, short
    text messages, phone calls etc.) for this purpose.

    If an application has a communication channel to the insured person, it can regularly poll if the state of the purchase application
    has changed and notify the person about changes. Such a channel is voluntary and in addition to the direct communication between
    pension fund and insured person.


    ## Payments

    Once the voluntary purchase has been approved, the amount can paid in one four ways:

    - **Single payment using a payment slip (QR bill)**: The pension fund provides the payment details (address,
    account number, reference number etc.) via API to the application used by the insured person. He/she makes
    a payment using the provided data.

    - **Single payment by eBill**: The pension fund sends an eBill to the insured person's eBill account.
    The insured person provides the eBill email address via the API to the pension fund.

    - **Periodic payments by eBill**: The insured person chooses a payment periodicity, which is sent
    to the pension fund via the API. The pension fund will later send an eBill for each payment to
    the insured person's eBill account.

    - **Irregular payments using a payment slip (QR bill)**: The pension fund provides the payment details (address,
    account number, reference number etc.)  via API to the application. The application then triggers payments
    (e.g. via an E-Banking-API). All payments use the same reference number.

    A pension fund does not need to support a four payment methods. An application can query the supported methods
    with an API call.


    ## Simulation

    The simulation calculates the prospective retirement capital and pension with and without voluntary purchase.
    Several parameters of the simulation can be specified:

    - Purchase amount (total)
    - Pension age
    - Amount of individual payments (if several payments are made towards a purchase)
    - Payment frequency (if several payments are made towards a purchase)
    - Date of (first) payment

    The simulation assumes that the legal prerequisites for the purchase are fulfilled. It checks that the maximum purchase amount is not
    exceeded and modifies it if needed.


    ## Transactions

    The Transactions endpoints provide the transactions affecting the retirement capital of a policy.


    ### Glossar / Glossary

    Folgende englischen Begriffe werden im API verwendet / The following English terms are used in the API :

    - **Social Security Number (SSN)**: Sozialversicherungsnummer (SVN) - 13 stellige, Schweizer Sozialversicherungsnummer.
    - **Mandatory / supplementary coverage**: Obligatorischer / überobligatorische Anteil / Deckung
    - **Retirement benefits**: Versicherungsleistungen bei Pensionierung (Altersrente und Altersguthaben)
    - **Risk benefits**: Versicherungsleistungen bei Invalidität und Tod
    - **Enveloping interest/conversion rate**: Umhüllender Zinssatz / Umwandlungssatz
    - **Retirement capital**: Altersguthaben / Alterskapital
    - **Savings contribution**: Sparbeitrag (Beitrag an Altersgutben)
    - **Risk contribution**: Risikobeitrag (Beitrag für Leistungen bei Invalidität und Tod)
    - **Vested benefits**: Freizügigkeitsleistungen
  # yamllint enable rule:indentiation

  contact:
    email: info@common-api.ch

  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

servers:
  - url: https://openpk.ch/v1

externalDocs:
  description: Find out more about SFTI API specifications
  url: https://www.common-api.ch

tags:
  - name: person
    description: Insured person.
  - name: statement
    description: Pension statement.
  - name: policy
    description: Pension fund policy.
  - name: simulation
    description: Simulations of salary changes and voluntary purchases.
  - name: purchase
    description: Voluntary purchase operations.
  - name: transactions
    description: Retirement capital transactions.

security:
  - bearerAuthentication: []

paths:
  /insured-persons/{personId}:
    get:
      summary: Get details of an insured person
      description: |
        Provides the details of the insured person, including name, address and
        additional data relevant in the Swiss social security system (birth date, sex etc.)
      operationId: getInsuredPerson
      tags:
        - person
      parameters:
        - in: path
          name: personId
          required: true
          schema:
            $ref: '#/components/schemas/PersonId'
          description: Technical person ID.
      responses:
        '200':
          description: Details of insured person
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InsuredPerson'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /insured-persons/{personId}/statements:
    post:
      summary: Get pension statement(s) data
      description: |
        Provides the pension statement(s) representing the state of the policy/policies for
        the specified date (or most recent regular/official statement(s) when date not given)
        as structured data.

        If the pension fund is unable to provide a statement for the request date, the error
        code 400 should be returned.
      operationId: getPensionStatementsByDate
      tags:
        - statement
      parameters:
        - in: path
          name: personId
          required: true
          schema:
            $ref: '#/components/schemas/PersonId'
          description: Technical person ID.
      requestBody:
        description: Reference date for information in output
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReferenceDate'
      responses:
        '200':
          description: Statement details
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PensionStatementBasic'
        '400':
          $ref: '#/components/responses/standard400'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /statements/{pensionStatementId}/documents:
    get:
      summary: Get the pension statement document for the specified id
      description: |
        Provides the pension statement for the specified id as a PDF document
        in the insured person's preferred language.

        If the pension fund is unable to provide a document for the request id, the error
        code 400 should be returned.
      operationId: getPensionStatementDocument
      tags:
        - statement
      parameters:
        - in: path
          name: pensionStatementId
          required: true
          schema:
            $ref: '#/components/schemas/PensionStatementId'
          description: Technical pension statement ID.
      responses:
        '200':
          description: Binary PDF data of the pension statement
          content:
            application/pdf:
              schema:
                type: string
                contentEncoding: binary
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /statements/{pensionStatementId}/statementForQrCode:
    get:
      summary: Get the pension statement QR code json for the specified id
      description: |
        Provides the pension statement for the specified id as a compact json
        in the insured person's preferred language. This json has the same content as
        defined in the PensionStatementBasic schema. Its sole purpose is to provide a
        compact json so it can be fit into a QR code. This endpoint should not be used
        otherwise and will be deprecated once the QR code is no longer needed.

        If the pension fund is unable to provide a json for the request id, the error
        code 400 should be returned.
      operationId: getPensionStatementQrCodeJson
      tags:
        - statement
      parameters:
        - in: path
          name: pensionStatementId
          required: true
          schema:
            $ref: '#/components/schemas/PensionStatementId'
          description: Technical pension statement ID.
      responses:
        '200':
          description: Compact statement details
          content:
            application/json:
              schema:
                type: object
                description: Basic, reduced pension statement consisting of only the most important information in compact form for QR code.
                required:
                  - pi
                  - en
                  - ppn
                  - rd
                  - pst
                  - pln
                  - ora
                  - era
                  - ds
                  - ism
                  - isre
                  - isri
                  - el
                  - brd
                  - bmr
                  - prb
                  - pd
                  - cpd
                  - ppd
                  - opd
                  - mlswpb
                  - fcsip
                  - fcse
                  - rpm
                  - hoaw
                properties:
                  psi:
                    $ref: '#/components/schemas/PensionStatementId'
                  pi:
                    $ref: '#/components/schemas/PersonId'
                  ei:
                    $ref: '#/components/schemas/EmployerId'
                  en:
                    $ref: '#/components/schemas/EmployerName'
                  in:
                    $ref: '#/components/schemas/Industry'
                  ppi:
                    $ref: '#/components/schemas/ProviderId'
                  ppn:
                    $ref: '#/components/schemas/ProviderName'
                  ppa:
                    type: object
                    description: Postal address of the pension provider.
                    properties:
                      st:
                        $ref: '#/components/schemas/Street'
                      pbo:
                        $ref: '#/components/schemas/PoBox'
                      to:
                        $ref: '#/components/schemas/Town'
                      pc:
                        $ref: '#/components/schemas/PostalCode'
                      cc:
                        $ref: '#/components/schemas/CountryCode'
                  pu:
                    $ref: '#/components/schemas/PortalUrl'
                  pn:
                    $ref: '#/components/schemas/PortalName'
                  psn:
                    $ref: '#/components/schemas/PensionStatementNo'
                  rd:
                    $ref: '#/components/schemas/Date'
                    description: Reference date of pension statement.
                  pst:
                    $ref: '#/components/schemas/PensionStatementType'
                  ed:
                    $ref: '#/components/schemas/Date'
                    description: Entry date into the pension fund.
                  ppl:
                    type: array
                    description: List of related pension plans.
                    items:
                      pli:
                        $ref: '#/components/schemas/PlanId'        
                      pln:
                        $ref: '#/components/schemas/PlanName'
                      ospn:
                        $ref: '#/components/schemas/OptionalSavingsPlanName'
                  ora:
                    type: integer
                    format: int32
                    description: Age (in month since birth) for ordinary retirement.
                    examples:
                      - 780
                  era:
                    type: integer
                    format: int32
                    description: Age (in month since birth) for earliest possible retirement.
                    examples:
                      - 696
                  ds:
                    $ref: '#/components/schemas/DeclaredSalary' 
                  bo:
                    $ref: '#/components/schemas/Bonus' 
                  as:
                    $ref: '#/components/schemas/AdditionalSalary' 
                  osc:
                    $ref: '#/components/schemas/OtherSalaryComponent' 
                  ism:
                    $ref: '#/components/schemas/InsuredSalaryMandatory' 
                  isre:
                    $ref: '#/components/schemas/InsuredSalaryRetirement' 
                  isri:
                    $ref: '#/components/schemas/InsuredSalaryRisk' 
                  el:
                    $ref: '#/components/schemas/EmploymentLevel'
                  tc:
                    $ref: '#/components/schemas/TransferredCapital'
                  tcm:
                    $ref: '#/components/schemas/TransferredCapitalMandatory'
                  brd:
                    $ref: '#/components/schemas/BalanceReferenceDate'
                  bmr:
                    $ref: '#/components/schemas/BalanceMandatoryReferenceDate'
                  bec:
                    $ref: '#/components/schemas/BalanceEndCurrentYear'
                  bmc:
                    $ref: '#/components/schemas/BalanceMandatoryEndCurrentYear'
                  prb:
                    type: array
                    description: |
                      Projected retirement benefits for a series of retirement ages.
                      The list contains projections for each integer retirement age from 58 to the
                      regular retirement age. For persons of 58 or older, the list is restricted
                      to retirement ages higher than their current age.
                    required:
                      - ra
                      - cb
                      - cbm
                      - p
                    items:
                      ra:
                        $ref: '#/components/schemas/RetirementAge'
                      cb:
                        $ref: '#/components/schemas/CapitalBalance'
                      cbm:
                        $ref: '#/components/schemas/CapitalBalanceMandatory'
                      cbni:
                        $ref: '#/components/schemas/CapitalBalanceNoInterest'
                      cbnim:
                        $ref: '#/components/schemas/CapitalBalanceNoInterestMandatory'
                      p:
                        $ref: '#/components/schemas/Pension'
                      crm:
                        $ref: '#/components/schemas/ConversionRateMandatory'
                      crs:
                        $ref: '#/components/schemas/ConversionRateSupplementary'
                      cre:
                        $ref: '#/components/schemas/ConversionRateEnveloping'
                  irms:
                    $ref: '#/components/schemas/InterestRate'
                    description: Saving interest rate for mandatory coverage (in percent).
                    examples:
                      - 6.800
                  irss:
                    $ref: '#/components/schemas/InterestRate'
                    description: Saving interest rate for supplementary coverage (in percent).
                    examples:
                      - 5.500
                  ires:
                    $ref: '#/components/schemas/InterestRate'
                    description: Saving enveloping interest rate for combined mandatory and supplementary coverage (in percent).
                    examples:
                      - 6.300
                  irme:
                    $ref: '#/components/schemas/InterestRate'
                    description: Interest rate for mandatory coverage (in percent), used specifically in purchase calculations.
                    examples:
                      - 6.800
                  irse:
                    $ref: '#/components/schemas/InterestRate'
                    description: Interest rate for supplementary coverage (in percent), used specifically in purchase calculations.
                    examples:
                      - 5.500
                  iree:
                    $ref: '#/components/schemas/InterestRate'
                    description: |
                      Enveloping interest rate for combined mandatory and supplementary coverage (in percent),
                      used specifically in purchase calculations.
                    examples:
                      - 6.300        
                  irmp:
                    $ref: '#/components/schemas/InterestRate'
                    description: |
                      Projection rate for mandatory coverage (in percent),
                      used specifically for calculating projected future values.
                    examples:
                      - 6.800
                  irsp:
                    $ref: '#/components/schemas/InterestRate'
                    description: |
                      Projection rate for supplementary coverage (in percent),
                      used specifically for calculating projected future values.
                    examples:
                      - 5.500
                  irep:
                    $ref: '#/components/schemas/InterestRate'
                    description: |
                      Projection enveloping interest rate for combined mandatory and supplementary coverage (in percent),
                      used specifically for calculating projected future values.
                    examples:
                      - 6.300
                  pd:
                    $ref: '#/components/schemas/PensionDisability'
                  cpd:
                    $ref: '#/components/schemas/ChildPensionDisability'
                  ppd:
                    $ref: '#/components/schemas/PartnerPensionDeath'
                  opd:
                    $ref: '#/components/schemas/OrphanPensionDeath'
                  lswpb:
                    $ref: '#/components/schemas/LumpSumWithoutPensionBenefits'
                  mlswpb:
                    $ref: '#/components/schemas/MinimalLumpSumWithPensionBenefits'
                  fcsip:
                    $ref: '#/components/schemas/ContributionSavingsInsuredPerson'
                  fcse:
                    $ref: '#/components/schemas/ContributionSavingsEmployer'
                  fcrip:
                    $ref: '#/components/schemas/ContributionRiskInsuredPerson'
                  fcre:
                    $ref: '#/components/schemas/ContributionRiskEmployer'
                  fcaip:
                    $ref: '#/components/schemas/ContributionAdministrationInsuredPerson'
                  fcae:
                    $ref: '#/components/schemas/ContributionAdministrationEmployer'
                  rpm:
                    $ref: '#/components/schemas/RegularPurchaseMaxAmount'
                  hoaw:
                    $ref: '#/components/schemas/HomeOwnershipAvailableForWithdrawal'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}:
    get:
      summary: Get details of a pension fund policy
      description: |
        Provides extensive details about the insurance policy including current retirement capital,
        prospective pension benefits for different retirement ages, contributions to financing the
        insurance etc.
      operationId: getPolicy
      tags:
        - policy
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Technical policy ID.
      responses:
        '200':
          description: Policy details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Policy'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/salary-change-simulation:
    post:
      summary: Simulate effects of salary and employment level change
      description: |
        Simulates the effects of a salaray and/or employment level change on contributions
        and prospective retirement benefits. Prospective retirements benefits are calculated
        for retirement at the regular age as well as for multiple early retirement ages.
      operationId: simulateSalaryChange
      tags:
        - simulation
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
      requestBody:
        description: Salary change simulation parameters
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SalaryChangeSimParameters'
      responses:
        '200':
          description: Simulation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SalaryChangeSimResult'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/purchase-simulation:
    post:
      summary: Simulate effects of voluntary purchase
      description: |
        Simulates the financial effect of voluntary purchase of additional pension benefits
        for the provided parameters (retirement age, purchase amount etc.)

        If the specified purchase amount is higher the maximum allowed purchase amount, it will
        be reduced to the allowed amount. The simulation result contains the effective purchase amount.

        For periodic payments, the simulation assumes that the payments are made with the specified
        payment size and payment frequency until the maximum purchase amount has been exhausted or
        the retirement date has been reached (whichever is first).

        If the retirement date is reached before the purchase amount is exhausted, the returned effective
        purchase amount will be lower than both the requested and the maximum purchase amount.

        Using a very high amount (e.g. CHF 10 million), it is possible to query the maximum purchase
        amount and the maximum additional pension at once.
      operationId: simulatePurchase
      tags:
        - simulation
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
      requestBody:
        description: Voluntary purchase simulation parameters
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SimulationParameters'
      responses:
        '200':
          description: Simulation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SimulationResult'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/purchases/template:
    get:
      summary: Retrieves a purchase request template
      description: |
        The template purchase request serves to retrieve the configuration
        and intial values for a new purchase request.
      operationId: getTemplatePurchaseRequest
      tags:
        - purchase
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
      responses:
        '200':
          description: Purchase request with configuration and initial values
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PurchaseRequest'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/purchases:
    get:
      summary: Query all purchase requests
      description: |
        Returns a list of all current and past purchase requests.
      operationId: listPurchaseRequest
      tags:
        - purchase
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
      responses:
        '200':
          description: List of purchase requests
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PurchaseRequest'
                description: List of purchase requests
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

    post:
      summary: Submit a new purchase request
      description: |
        Submit a new purchase request for voluntary purchase of additional pension benefits.

        The submitted data must satisfy the requirements described above,
        in particular which questions require an answer.

        The response will contain an ID that can be used to query the submitted request in the future.
      operationId: submitPurchaseRequest
      tags:
        - purchase
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
      requestBody:
        description: Voluntary purchase request details
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PurchaseRequest'
      responses:
        '200':
          description: Updated voluntary purchase request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PurchaseRequest'
        '400':
          $ref: '#/components/responses/standard400'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/purchases/{purchaseRequestId}:
    get:
      summary: Get purchase request
      description: |
        Retrieves the current state of the specified purchase request.
      operationId: getPurchaseRequest
      tags:
        - purchase
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
        - in: path
          name: purchaseRequestId
          required: true
          schema:
            $ref: '#/components/schemas/PurchaseRequestId'
          description: Purchase Request ID.
      responses:
        '200':
          description: Vvoluntary purchase request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PurchaseRequest'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

    put:
      summary: Update purchase request.
      description: |
        Updates the insured person's input in the specified purchase request.

        Updates are usually on possible if the request is in the state `inputRequired`.
      operationId: updatePurchaseRequest
      tags:
        - purchase
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
        - in: path
          name: purchaseRequestId
          required: true
          schema:
            $ref: '#/components/schemas/PurchaseRequestId'
          description: Purchase Request ID.
      requestBody:
        description: Voluntary purchase request details.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PurchaseRequest'
      responses:
        '200':
          description: Updated voluntary purchase request.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PurchaseRequest'
        '400':
          $ref: '#/components/responses/standard400'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/payment-methods:
    get:
      summary: Retrieves the available payment methods
      description: |
        Returns the list of methods available to make payments for
        a voluntary purchase of pension benefits.
      operationId: getPaymentMethods
      tags:
        - purchase
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Policy ID.
      responses:
        '200':
          description: List of payment methods.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PaymentMethod'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

  /policies/{policyId}/transactions:
    get:
      summary: Get the retirement capital transactions
      description: |
        Retrieves all transactions affecting the policy's retirement capital in the specified
        date range.

        The resulting transaction list is sorted in chronological order, starting with the oldest
        transaction. If several transactions occurred on the same date, they are ordered such that
        adding the transaction amount to the previous transactions balance results in the balance
        provided by the current transaction.

        The first transaction in the list is a pseudo transaction providing the carryover balance
        from the previous period. It is the only transaction with the category `carryover`.

        The `from` date must be before or be equal to the `to` date.

        The result contains a date range as well. It is usually equal to the request date range.
        However, if the requested `from` date is before the start of the policy or if the
        request `to` date is in the future, the date range may be adjusted to reflect the
        effective date range.
      operationId: getRetirementCapitalTransactions
      tags:
        - transactions
      parameters:
        - in: path
          name: policyId
          required: true
          schema:
            $ref: '#/components/schemas/PolicyId'
          description: Technical policy ID.
        - in: query
          name: from
          required: true
          schema:
            $ref: '#/components/schemas/Date'
          description: Start of date range (inclusive).
        - in: query
          name: to
          required: true
          schema:
            $ref: '#/components/schemas/Date'
          description: End of date range (inclusive).
      responses:
        '200':
          description: Retirement capital transactions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Transactions'
        '400':
          $ref: '#/components/responses/standard400'
        '401':
          $ref: '#/components/responses/standard401'
        '404':
          $ref: '#/components/responses/standard404'

components:
  schemas:
    InsuredPerson:
      type: object
      description: Details of insured person.
      required:
        - personId
        - lastName
        - firstName
        - birthDate
        - sex
        - maritalStatus
        - ssn
      properties:
        personId:
          $ref: '#/components/schemas/PersonId'
        lastName:
          type: string
          description: Last name / family name.
          examples:
            - Doe
        firstName:
          type: string
          description: First name(s).
          examples:
            - John
        address:
          $ref: '#/components/schemas/Address'
        birthDate:
          $ref: '#/components/schemas/Date'
          description: Birth date.
        sex:
          type: string
          enum:
            - male
            - female
          description: |
            Sex:
            * `male`: male
            * `female`: female
          examples:
            - male
        maritalStatus:
          type: string
          enum:
            - single
            - married
            - divorced
            - widowed
            - registeredPartnership
            - dissolvedRegisteredPartnership
            - unknown
          description: |
            Marital status:
            * `single`: single
            * `married`: married
            * `divorced`: divorced
            * `widowed`: widowed
            * `registeredPartnership`: living in a registered partnership
            * `dissolvedRegisteredPartnership`: registered partnership has been dissolved
            * `unknown`: marital status is not known
          examples:
            - married
        marriageDate:
          $ref: '#/components/schemas/Date'
          description: Date of marriage (or registration of partnership).
        ssn:
          type: integer
          format: int64
          description: Social security number.
          examples:
            - 7561234567890
        policyIds:
          type: array
          items:
            $ref: '#/components/schemas/PolicyId'
          description: List of IDs of policies that insured person has with this pension fund.
        disabilityDegree:
          type: integer
          format: int32
          minimum: 0
          maximum: 100
          description: |
            Degree (percent) of disability according to OASI (AHV/IV).
            If not specified, 0 is assumed.
          examples:
            - 0
        healthReservations:
          type: array
          items:
            $ref: '#/components/schemas/HealthReservation'
          description: List of health reservations.

    Address:
      type: object
      description: Postal/residence address.
      required:
        - street
        - town
        - postalCode
        - countryCode
      properties:
        street:
          $ref: '#/components/schemas/Street'
        poBox:
          $ref: '#/components/schemas/PoBox'
        town:
          $ref: '#/components/schemas/Town'
        postalCode:
          $ref: '#/components/schemas/PostalCode'
        countryCode:
          $ref: '#/components/schemas/CountryCode'

    Street:
      type: string
      description: Street and house number.
      examples:
        - Brandstrasse 2

    PoBox:
      type: string
      description: PO box.
      examples:
        - PO Box 42

    Town:
      type: string
      description: Town.
      examples:
        - Unterbäch

    PostalCode:
      type: string
      description: Postal code.
      examples:
        - '3944'

    CountryCode:
      type: string
      pattern: '^[A-Z]{2}$'
      description: ISO country code.
      examples:
        - CH

    PensionProvider:
      type: object
      description: Pension provider (foundation) administering the policy.
      required:
        - providerName
      properties:
        providerId:
          $ref: '#/components/schemas/ProviderId'
        providerName:
          $ref: '#/components/schemas/ProviderName'
        providerAddress:
          $ref: '#/components/schemas/Address'
          description: Postal address of the pension provider.
        portalUrl:
          $ref: '#/components/schemas/PortalUrl'
        portalName:
          $ref: '#/components/schemas/PortalName'

    Employer:
      type: object
      description: Details of the insured person's employer.
      required:
        - name
      properties:
        employerId:
          $ref: '#/components/schemas/EmployerId'
        employerName:
          $ref: '#/components/schemas/EmployerName'
        industry:
          $ref: '#/components/schemas/Industry'

    PensionStatementBasic:
      type: object
      description: Basic, reduced pension statement consisting of only the most important information.
      required:
        - personId
        - employer
        - pensionProvider
        - referenceDate
        - pensionStatementType
        - pensionPlans
        - ordinaryRetirementAge
        - earliestRetirementAge
        - salaryData
        - retirementCapital
        - riskBenefits
        - financing
        - regularPurchaseMaxAmount
        - homeOwnershipAvailableForWithdrawal
      properties:
        pensionStatementId:
          $ref: '#/components/schemas/PensionStatementId'
        personId:
          $ref: '#/components/schemas/PersonId'
        employer:
          $ref: '#/components/schemas/Employer'
        pensionProvider:
          $ref: '#/components/schemas/PensionProvider'
        pensionStatementNo:
          $ref: '#/components/schemas/PensionStatementNo'
        referenceDate:
          $ref: '#/components/schemas/Date'
          description: Reference date of pension statement.
        pensionStatementType:
          $ref: '#/components/schemas/PensionStatementType'
        entryDate:
          $ref: '#/components/schemas/Date'
          description: Entry date into the pension fund.
        pensionPlans:
          type: array
          description: List of related pension plans.
          items:
            $ref: '#/components/schemas/PensionPlan'
        ordinaryRetirementAge:
          type: integer
          format: int32
          description: Age (in month since birth) for ordinary retirement.
          examples:
            - 780
        earliestRetirementAge:
          type: integer
          format: int32
          description: Age (in month since birth) for earliest possible retirement.
          examples:
            - 696
        salaryData:
          $ref: '#/components/schemas/SalaryData'
        retirementCapital:
          $ref: '#/components/schemas/RetirementCapital'
        riskBenefits:
          $ref: '#/components/schemas/RiskBenefits'
        financing:
          $ref: '#/components/schemas/Financing'
        regularPurchaseMaxAmount:
          $ref: '#/components/schemas/RegularPurchaseMaxAmount'
        homeOwnershipAvailableForWithdrawal:
          $ref: '#/components/schemas/HomeOwnershipAvailableForWithdrawal'

    Policy:
      type: object
      description: Details of policy.
      required:
        - policyId
        - personId
        - pensionProvider
        - policyNo
        - entryDate
        - salaryData
        - retirementCapital
        - riskBenefits
        - financing
      properties:
        policyId:
          $ref: '#/components/schemas/PolicyId'
        personId:
          $ref: '#/components/schemas/PersonId'
        pensionProvider:
          $ref: '#/components/schemas/PensionProvider'
        policyNo:
          type: string
          description: Policy number (as printed on policy statements).
          examples:
            - 392'485'482
        entryDate:
          $ref: '#/components/schemas/Date'
          description: Entry date into policy
        contractNo:
          type: string
          description: Contract number of contract between employer and pension fund.
          examples:
            - C27-842.183
        pensionPlan:
          $ref: '#/components/schemas/PensionPlan'
        isInVestedBenefitFoundation:
          type: boolean
          description: |
            Indicates if policy is part of a vested benefit foundation (as opposed to
            a regular pension fund with payments from an employer). If the field is not
            set, a regular pension fund is assumed.
          examples:
            - false
        salaryData:
          $ref: '#/components/schemas/SalaryData'
        retirementCapital:
          $ref: '#/components/schemas/RetirementCapital'
        riskBenefits:
          $ref: '#/components/schemas/RiskBenefits'
        financing:
          $ref: '#/components/schemas/Financing'
        vestedBenefits:
          $ref: '#/components/schemas/VestedBenefits'
        regularPurchaseMaxAmount:
          $ref: '#/components/schemas/RegularPurchaseMaxAmount'
        homeOwnershipAvailableForWithdrawal:
          $ref: '#/components/schemas/HomeOwnershipAvailableForWithdrawal'

    PensionPlan:
      type: object
      description: |
        The pension plan defines various conditions for the occupational pension provision
        of the insured employees, incl. the contributions and insured benefits.
      required:
        - planName
      properties:
        planId:
          $ref: '#/components/schemas/PlanId'        
        planName:
          $ref: '#/components/schemas/PlanName'
        optionalSavingsPlanName:
          $ref: '#/components/schemas/OptionalSavingsPlanName'

    PlanId:
      type: string
      pattern: '^[A-Za-z0-9_\-.~]{1,64}$'
      description: Technical ID of pension plan used in API calls.
      examples:
        - Plan_XY4284_425   
       
    PlanName:
      type: string
      description: Insurance plan name.
      examples:
        - Basisplan

    OptionalSavingsPlanName:
      type: string
      description: Name of the optional savings plan.
      examples:
        - Sparplan 2

    SalaryData:
      type: object
      description: Details of salary relevant for insurance.
      required:
        - declaredSalary
        - insuredSalaryMandatory
        - insuredSalaryRetirement
        - insuredSalaryRisk
        - employmentLevel
      properties:
        declaredSalary:
          $ref: '#/components/schemas/DeclaredSalary' 
        bonus:
          $ref: '#/components/schemas/Bonus' 
        additionalSalary:
          $ref: '#/components/schemas/AdditionalSalary' 
        otherSalaryComponent:
          $ref: '#/components/schemas/OtherSalaryComponent' 
        insuredSalaryMandatory:
          $ref: '#/components/schemas/InsuredSalaryMandatory' 
        insuredSalaryRetirement:
          $ref: '#/components/schemas/InsuredSalaryRetirement' 
        insuredSalaryRisk:
          $ref: '#/components/schemas/InsuredSalaryRisk' 
        employmentLevel:
          $ref: '#/components/schemas/EmploymentLevel' 

    DeclaredSalary:
      type: number
      format: double
      description: Gross annual salary.
      examples:
        - 78000.00

    Bonus:
      type: number
      format: double
      description: Bonus component of the salary.
      examples:
        - 0.00

    AdditionalSalary:
      type: number
      format: double
      description: Additional salary component.
      examples:
        - 0.00

    OtherSalaryComponent:
      type: number
      format: double
      description: Other salary component.
      examples:
        - 0.00

    InsuredSalaryMandatory:
      type: number
      format: double
      description: Annual salary insured under mandatory coverage.
      examples:
        - 59215.00

    InsuredSalaryRetirement:
      type: number
      format: double
      description: Annual salary insured for retirement benefits (mandatory and supplementary coverage).
      examples:
        - 59215.00

    InsuredSalaryRisk:
      type: number
      format: double
      description: Annual salary insured for risk benefits (mandatory and supplementary coverage).
      examples:
        - 59215.00

    EmploymentLevel:
      type: number
      format: double
      description: Level of full-time/part-time employment (in percent, 100 for full-time employment).
      examples:
        - 100

    RetirementCapital:
      type: object
      description: Retirement capital balances for the past and projections for the future.
      required:
        - balanceReferenceDate
        - balanceMandatoryReferenceDate
        - projectedRetirementBenefits
        - interestRates
      properties:
        transferredCapital:
          $ref: '#/components/schemas/TransferredCapital'
        transferredCapitalMandatory:
          $ref: '#/components/schemas/TransferredCapitalMandatory'
        balanceReferenceDate:
          $ref: '#/components/schemas/BalanceReferenceDate'
        balanceMandatoryReferenceDate:
          $ref: '#/components/schemas/BalanceMandatoryReferenceDate'
        balanceEndCurrentYear:
          $ref: '#/components/schemas/BalanceEndCurrentYear'
        balanceMandatoryEndCurrentYear:
          $ref: '#/components/schemas/BalanceMandatoryEndCurrentYear'
        projectedRetirementBenefits:
          type: array
          description: |
            Projected retirement benefits for a series of retirement ages.
            The list contains projections for each integer retirement age from 58 to the
            regular retirement age. For persons of 58 or older, the list is restricted
            to retirement ages higher than their current age.
          items:
            $ref: '#/components/schemas/RetirementBenefits'
        interestRates:
          $ref: '#/components/schemas/InterestRates'

    TransferredCapital:
      type: number
      format: double
      description: Total retirement capital (mandatory and supplementary coverage) brought from other funds into this fund.
      examples:
        - 45210.25

    TransferredCapitalMandatory:
      type: number
      format: double
      description: Retirement capital under mandatory coverage brought from other funds into this fund.
      examples:
        - 32840.55

    BalanceReferenceDate:
      type: number
      format: double
      description: Retirement capital as per a specified reference date (mandatory and supplementary coverage).
      examples:
        - 53842.50

    BalanceMandatoryReferenceDate:
      type: number
      format: double
      description: Retirement capital under mandatory coverage as per a specified reference date.
      examples:
        - 38942.15

    BalanceEndCurrentYear:
      type: number
      format: double
      description: Projected retirement capital as per end of the current year (mandatory and supplementary coverage).
      examples:
        - 56325.25

    BalanceMandatoryEndCurrentYear:
      format: double
      type: number
      description: Projected retirement capital under mandatory coverage as per end of the current year.
      examples:
        - 40846.60

    RetirementBenefits:
      type: object
      description: |
        Retirement benefits for retirement at the specified age.
        The conversion rate is mandatory: either the pair for mandatory and supplementary
        coverage is provided, or the enveloping conversion rate.
      required:
        - retirementAge
        - capitalBalance
        - capitalBalanceMandatory
        - pension
      properties:
        retirementAge:
          $ref: '#/components/schemas/RetirementAge'
        capitalBalance:
          $ref: '#/components/schemas/CapitalBalance'
        capitalBalanceMandatory:
          $ref: '#/components/schemas/CapitalBalanceMandatory'
        capitalBalanceNoInterest:
          $ref: '#/components/schemas/CapitalBalanceNoInterest'
        capitalBalanceNoInterestMandatory:
          $ref: '#/components/schemas/CapitalBalanceNoInterestMandatory'
        pension:
          $ref: '#/components/schemas/Pension'
        conversionRateMandatory:
          $ref: '#/components/schemas/ConversionRateMandatory'
        conversionRateSupplementary:
          $ref: '#/components/schemas/ConversionRateSupplementary'
        conversionRateEnveloping:
          $ref: '#/components/schemas/ConversionRateEnveloping'

    RetirementAge:
      type: integer
      format: int32
      description: Specified age (in month since birth) used for the retirement benefits calculation.
      examples:
        - 756

    CapitalBalance:
      type: number
      format: double
      description: Retirement capital balance with interest (mandatory and supplementary coverage).
      examples:
        - 378832.05

    CapitalBalanceMandatory:
      type: number
      format: double
      description: Retirement capital balance with interest (mandatory coverage only).
      examples:
        - 284832.15

    CapitalBalanceNoInterest:
      type: number
      format: double
      description: |
        Retirement capital balance assuming no interest on assets (mandatory
        and supplementary coverage)
      examples:
        - 331285.25

    CapitalBalanceNoInterestMandatory:
      type: number
      format: double
      description: |
        Retirement capital balance assuming no interest on assets (mandatory coverage only)
      examples:
        - 248862.65

    Pension:
      type: number
      format: double
      description: Annual pension credit.
      examples:
        - 22835.00

    ConversionRateMandatory:
      type: number
      format: double
      description: Conversion rate (capital to pension) for mandatory coverage.
      examples:
        - 6.800

    ConversionRateSupplementary:
      type: number
      format: double
      description: Conversion rate (capital to pension) for supplementary coverage.
      examples:
        - 5.500

    ConversionRateEnveloping:
      type: number
      format: double
      description: |
        Enveloping conversion rate (capital to pension) for combined mandatory and
        supplementary coverage
      examples:
        - 6.300

    InterestRates:
      type: object
      description: |
        A set of interest rates applicable/applied to the retirement capital, including
        actual rates for mandatory and supplementary coverage. Rates for saving/purchase
        and projection rates for future value calculations.
      properties:
        interestRateMandatorySaving:
          $ref: '#/components/schemas/InterestRate'
          description: Saving interest rate for mandatory coverage (in percent).
          examples:
            - 6.800
        interestRateSupplementarySaving:
          $ref: '#/components/schemas/InterestRate'
          description: Saving interest rate for supplementary coverage (in percent).
          examples:
            - 5.500
        interestRateEnvelopingSaving:
          $ref: '#/components/schemas/InterestRate'
          description: Saving enveloping interest rate for combined mandatory and supplementary coverage (in percent).
          examples:
            - 6.300
        interestRateMandatoryPurchase:
          $ref: '#/components/schemas/InterestRate'
          description: Interest rate for mandatory coverage (in percent), used specifically in purchase calculations.
          examples:
            - 6.800
        interestRateSupplementaryPurchase:
          $ref: '#/components/schemas/InterestRate'
          description: Interest rate for supplementary coverage (in percent), used specifically in purchase calculations.
          examples:
            - 5.500
        interestRateEnvelopingPurchase:
          $ref: '#/components/schemas/InterestRate'
          description: |
            Enveloping interest rate for combined mandatory and supplementary coverage (in percent),
            used specifically in purchase calculations.
          examples:
            - 6.300        
        interestRateMandatoryProjection:
          $ref: '#/components/schemas/InterestRate'
          description: |
            Projection rate for mandatory coverage (in percent),
            used specifically for calculating projected future values.
          examples:
            - 6.800
        interestRateSupplementaryProjection:
          $ref: '#/components/schemas/InterestRate'
          description: |
            Projection rate for supplementary coverage (in percent),
            used specifically for calculating projected future values.
          examples:
            - 5.500
        interestRateEnvelopingProjection:
          $ref: '#/components/schemas/InterestRate'
          description: |
            Projection enveloping interest rate for combined mandatory and supplementary coverage (in percent),
            used specifically for calculating projected future values.
          examples:
            - 6.300

    RiskBenefits:
      type: object
      description: Benefits in case of death or disability to work.
      required:
        - pensionDisability
        - childPensionDisability
        - partnerPensionDeath
        - orphanPensionDeath
        - minimalLumpSumWithPensionBenefits
      properties:
        pensionDisability:
          $ref: '#/components/schemas/PensionDisability'
        childPensionDisability:
          $ref: '#/components/schemas/ChildPensionDisability'
        partnerPensionDeath:
          $ref: '#/components/schemas/PartnerPensionDeath'
        orphanPensionDeath:
          $ref: '#/components/schemas/OrphanPensionDeath'
        lumpSumWithoutPensionBenefits:
          $ref: '#/components/schemas/LumpSumWithoutPensionBenefits'
        minimalLumpSumWithPensionBenefits:
          $ref: '#/components/schemas/MinimalLumpSumWithPensionBenefits'

    PensionDisability:
      type: number
      format: double
      description: Annual pension in case of disability.
      examples:
        - 40213.00

    ChildPensionDisability:
      type: number
      format: double
      description: Annual child pension in case of disability.
      examples:
        - 5382.00

    PartnerPensionDeath:
      type: number
      format: double
      description: Annual partner pension in case of death.
      examples:
        - 24817.00

    OrphanPensionDeath:
      type: number
      format: double
      description: Annual orphan pension in case of death.
      examples:
        - 5382.00

    LumpSumWithoutPensionBenefits:
      type: number
      format: double
      description: One-off payment in case of death where no other benefits are paid out.
      examples:
        - 92834.00

    MinimalLumpSumWithPensionBenefits:
      type: number
      format: double
      description: |
        Guaranteed, minimal one-off payment in case of death where other benefits are paid out.
      examples:
        - 74383.00

    Financing:
      type: object
      description: Contributions for financing the policy.
      required:
        - contributionSavingsInsuredPerson
        - contributionSavingsEmployer
      properties:
        contributionSavingsInsuredPerson:
          $ref: '#/components/schemas/ContributionSavingsInsuredPerson'
        contributionSavingsEmployer:
          $ref: '#/components/schemas/ContributionSavingsEmployer'
        contributionRiskInsuredPerson:
          $ref: '#/components/schemas/ContributionRiskInsuredPerson'
        contributionRiskEmployer:
          $ref: '#/components/schemas/ContributionRiskEmployer'
        contributionAdministrationInsuredPerson:
          $ref: '#/components/schemas/ContributionAdministrationInsuredPerson'
        contributionAdministrationEmployer:
          $ref: '#/components/schemas/ContributionAdministrationEmployer'

    ContributionSavingsInsuredPerson:
      type: number
      format: double
      description: Annual contribution towards the retirement captial financed by the insured person.
      examples:
        - 4025.00

    ContributionSavingsEmployer:
      type: number
      format: double
      description: Annual contribution towards the retirement captial financed by the employer.
      examples:
        - 4025.00

    ContributionRiskInsuredPerson:
      type: number
      format: double
      description: Annual contribution towards risk benefits financed by the insured person.
      examples:
        - 0.00

    ContributionRiskEmployer:
      type: number
      format: double
      description: Annual contribution towards risk benefits financed by the employer.
      examples:
        - 0.00

    ContributionAdministrationInsuredPerson:
      type: number
      format: double
      description: Annual contribution towards fund administration financed by the insured person.
      examples:
        - 0.00

    ContributionAdministrationEmployer:
      type: number
      format: double
      description: Annual contribution towards fund administration financed by the employer.
      examples:
        - 0.00

    VestedBenefits:
      type: object
      description: Detail information about vested benefits.
      properties:
        referenceDate:
          $ref: '#/components/schemas/Date'
          description: Reference date of the vested benefit information.
        capitalAt50:
          type: number
          format: double
          description: |
            The insured person's retirement capital when he/she was 50 (mandatory and supplementary).
            Empty for persons younger than 50.
          examples:
            - 0.00
        capitalAt50Mandatory:
          type: number
          format: double
          description: |
            The insured person's retirement capital when he/she was 50 (mandatory part only).
            Empty for persons younger than 50.
          examples:
            - 0.00
        capitalAtMarriage:
          type: number
          format: double
          description: |
            The insured person's retirement capital before he/she got married or entered
            a registered partnership (mandatory and supplementary). Relevant is the last
            marriage or registered partnership (the marriage/partnership date is part of
            the insured person object.)
            Empty for persons who are not married or in a registered partnership.
          examples:
            - 28483.35
        capitalAtMarriageMandatory:
          type: number
          format: double
          description: |
            The insured person's retirement capital before he/she got married or entered
            a registered partnership (mandatory part only). Relevant is the last
            marriage or registered partnership (the marriage/partnership date is part of
            the insured person object.)
            Empty for persons who are not married or in a registered partnership.
          examples:
            - 23863.15
        capitalFirstCommunicated:
          type: number
          format: double
          description: |
            Vested benefit capital that has been initially communicated or had become due
            after January 1, 1995 (for insured persons having married before January 1, 1995).
          examples:
            - 0.00
        capitalFirstCommunicatedDate:
          $ref: '#/components/schemas/Date'
          description: |
            Date when vested benefit capital has been initially communicated or had become due
            after January 1, 1995 (for insured persons having married before January 1, 1995).
        voluntaryPurchases:
          type: array
          items:
            $ref: '#/components/schemas/CapitalTransaction'
          description: |
            List of voluntary purchases of additional pension benefits made in the past.
            At least the purchases of the last 3 years must be included. They can be
            aggregated by calendar year.
        homeOwnerhsipWithdrawals:
          type: array
          items:
            $ref: '#/components/schemas/CapitalTransaction'
          description: |
            List of withdrawls and refunds for home ownership promotion made in the past.
        divorceWithdrawals:
          type: array
          items:
            $ref: '#/components/schemas/CapitalTransaction'
          description: |
            List of withdrawls and refunds due to divorce made in the past.
        pledges:
          type: array
          items:
            $ref: '#/components/schemas/Pledge'
          description: |
            List of pledges of parts of the retirement capital.

    CapitalTransaction:
      type: object
      description: |
        Capital transaction made by the insured persons. It includes volunatry purchases,
        withdrawals for and refunds of home ownerhsip promotion, withdrawals or refunds due to divorce.
      required:
        - date
        - amount
        - amountMandatory
      properties:
        date:
          $ref: '#/components/schemas/Date'
          description: Date of transaction
        amount:
          type: number
          format: double
          description: |
            Total transaction amount for mandatory and supplementary part.
            The amount is positive for payments towards the capital, and negative for withdrawals.
          examples:
            - 0.00
        amountMandatory:
          type: number
          format: double
          description: |
            Transaction amount for mandatory part only.
            The amount is positive for payments towards the capital, and negative for withdrawals.
          examples:
            - 0.00

    RegularPurchaseMaxAmount:
      type: number
      format: double
      description: |
        The maximum amount the insured person is permitted to contribute to their pension plan
        as an ordinary purchase.
      examples:
        - 48392.45

    HomeOwnershipAvailableForWithdrawal:
      type: number
      format: double
      description: |
        The total amount available for the insured person to withdraw or borrow against from their retirement capital for the purpose of financing home ownership.
      examples:
        - 31000.00

    HealthReservation:
      type: object
      description: |
        Period of health reservation.
      required:
        - startDate
      properties:
        startDate:
          $ref: '#/components/schemas/Date'
          description: Start date of health reservation.
        endDate:
          $ref: '#/components/schemas/Date'
          description: |
            End date of health reservation.
            If no end date is specified, the health reservation is currently still in force.

    Pledge:
      type: object
      description: |
        Details about pledged capital.
      properties:
        amount:
          type: number
          format: double
          description: |
            Amount of retirement capital used for pledging (mandatory and supplementary).
          examples:
            - 20000.00
        amountMandatory:
          type: number
          format: double
          description: |
            Amount of retirement capital used for pledging (mandatory part only).
          examples:
            - 20000.00
        pledgee:
          type: string
          description: The name of the pledgee.
          examples:
            - UBS AG
        pledgeeAddress:
          $ref: '#/components/schemas/Address'

    ReferenceDate:
      type: object
      description: Reference date for information in generated document.
      required:
        - referenceDate
      properties:
        referenceDate:
          $ref: '#/components/schemas/Date'

    PersonId:
      type: string
      pattern: '^[A-Za-z0-9_\-.~]{1,64}$'
      description: Technical ID of insured person used in API calls.
      examples:
        - JohnDoe_1234

    ProviderId:
      type: string
      description: Swiss Enterprise Identification Number UID.
      examples:
        - CHE123456789

    ProviderName:
      type: string
      description: The name of the pension provider.
      examples:
        - Omnifund

    PortalUrl:
      type: string
      description: URL of the insurance portal of the pension fund.
      examples:
        - www.omnifund.ch

    PortalName:
      type: string
      description: Offical name of the insurance portal.
      examples:
        - Omni Portal

    EmployerId:
      type: string
      description: Swiss Enterprise Identification Number UID.
      examples:
        - CHE115873291

    EmployerName:
      type: string
      description: The name of the employer.
      examples:
        - Acrea AG

    Industry:
      type: string
      description: The industry or sector the employer operates in.
      examples:
        - information technology and management consulting

    PolicyId:
      type: string
      pattern: '^[A-Za-z0-9_\-.~]{1,64}$'
      description: Technical ID of policy used in API calls.
      examples:
        - Pol_56789-2024

    PensionStatementId:
      type: string
      pattern: '^[A-Za-z0-9_\-.~]{1,64}$'
      description: Technical ID of pension statement used in API calls.
      examples:
        - 550e8450-e59b-21d4-a346-442215440560

    PensionStatementNo:
      type: string
      description: Pension statement number (as printed on statement).
      examples:
        - PS_ID_6789-ABC

    PensionStatementType:
      type: string
      enum:
        - regular
        - simulated
      description: |
        pension statement type:
        * `regular`: the pension statement is an offical, regular statement on the basis of real values (not changed for simulation purposes)
        * `simulated`: the pension statement is a non-offical, simulated statement, i.e. some values might have been changed for simulation purposes
      examples:
        - regular

    SalaryChangeSimParameters:
      type: object
      description: Salary change simulation parameters.
      required:
        - declaredSalary
        - employmentLevel
      properties:
        declaredSalary:
          type: number
          format: double
          description: Changed gross annual salary in CHF (for employment level 100%).
          examples:
            - 80000
        employmentLevel:
          type: number
          format: double
          description: Changed level of full-time/part-time employment (in percent, 100 for full-time employment).
          examples:
            - 80
        effectiveDate:
          $ref: '#/components/schemas/Date'
          description: |
            Date when the salary change takes effect.
            If omitted: tomorrow.

    SalaryChangeSimResult:
      type: object
      description: Financial effect of voluntary purchase.
      required:
        - salaryData
        - projectedRetirementBenefits
        - financing
      properties:
        salaryData:
          $ref: '#/components/schemas/SalaryData'
        projectedRetirementBenefits:
          type: array
          description: |
            Projected retirement benefits for a series of retirement ages.
            The list contains projections for each integer retirement age from 58 to the
            regular retirement age. For persons of 58 or older, the list is restricted
            to retirement ages higher than their current age.
          items:
            $ref: '#/components/schemas/RetirementBenefits'
        financing:
          $ref: '#/components/schemas/Financing'

    SimulationParameters:
      type: object
      description: Voluntary purchase simulation parameters.
      required:
        - totalAmount
      properties:
        totalAmount:
          type: number
          description: |
            Purchase amount in CHF.
            For periodic purchases, the sum of all payments.
          examples:
            - 10000.00
        retirementAge:
          type: integer
          description: |
            Planned retirement age (in month since birth).
            If omitted, the regular payment age is assumed.
          examples:
            - 780
        date:
          $ref: '#/components/schemas/Date'
          description: |
            Date of the (first) payments.
            If omitted: tomorrow.
        paymentSize:
          type: number
          description: |
            The size of individual periodic payments.
            If omitted, 0 or equal to 'amount', a one-time payment is assumed.
          examples:
            - 10000.00
        paymentFrequency:
          $ref: '#/components/schemas/PaymentFrequency'

    SimulationResult:
      type: object
      description: Financial effect of voluntary purchase.
      required:
        - maxAmount
        - amount
        - retirementAge
        - capitalWithoutPurchase
        - capitalWithPurchase
        - pensionWithoutPurchase
        - pensionWithPurchase
      properties:
        maxAmount:
          type: number
          description: Maximum allowed amount of voluntary purchase of additional pension benefits (in CHF).
          examples:
            - 48392.45
        amount:
          type: number
          description: Effective amount of voluntary purchase (in CHF).
          examples:
            - 10000.00
        retirementAge:
          type: integer
          description: Retirement age (in month since birth) assumed for simulation.
          examples:
            - 780
        capitalWithoutPurchase:
          type: number
          description: Prospective savings capital at retirement without purchase (in CHF).
          examples:
            - 378832.05
        capitalWithPurchase:
          type: number
          description: Prospective savings capital at retirement with purchase (in CHF).
          examples:
            - 390216.55
        pensionWithoutPurchase:
          type: number
          description: Prospective pension after retirement without purchase (in CHF per year).
          examples:
            - 22835.00
        pensionWithPurchase:
          type: number
          description: Prospective pension after retirement with purchase (in CHF per year).
          examples:
            - 23517.00

    PurchaseRequest:
      type: object
      description: |
        The *Purchase Request* object is the main data structure exchanged between application and pension fund
        during the voluntary purchase process. It is updated by the the application and the pension fund.

        The application updates:
        - purchaseDetails
        - paymentSchedule

        The pension fund updates:
        - id
        - status
        - purchaseDetails
        - requiredPurchaseDetails
        - instructions
        - paymentInstructions
        - paymentsReceived

        The application should omit the above fields. If they are part of a REST request, the pension fund
        will silently ignore them.

        The application may only update the purchase request on creation and if it is in status `inputRequired`.

        The pension fund will not update `purchaseDetails` except for minor cleanup (e.g. removing trailing whitespace)
        that does not alter the insured person's input materially. The only exception is the purchase amount, which may
        be lowered to maximum allowed amount.
      properties:
        id:
          $ref: '#/components/schemas/PurchaseRequestId'
        status:
          type: string
          description: |
            Request status (set and updated by pension fund):
            * `inReview` - Request was submitted and is in review
            * `inputRequired` - Request requires additional input from insured person
            * `rejected` - Request was rejected
            * `approved` - Request was approved and is open for payments
            * `completed` - Payment has been received and request is complete
          enum:
            - inReview
            - inputRequired
            - rejected
            - approved
            - completed
          examples:
            - inReview
        purchaseDetails:
          $ref: '#/components/schemas/PurchaseDetails'
        requiredPurchaseDetails:
          $ref: '#/components/schemas/RequiredPurchaseDetails'
        instructions:
          $ref: '#/components/schemas/Instructions'
        paymentSchedule:
          $ref: '#/components/schemas/PaymentSchedule'
        paymentInstructions:
          $ref: '#/components/schemas/PaymentInstructions'
        paymentsReceived:
          type: number
          format: double
          minimum: 0
          description: Total amount of payments received (in CHF).
          examples:
            - 10000.00

    PurchaseDetails:
      type: object
      description: |
        Input from the insured person regarding the purchase request. These are the answers to the questions
        described in detail in the introduction to this API. Most of the questions and answers are required to
        ensure the purchase amount does not exceed the maximum allowed amount.

        Some questions and answers are optional (in the sense that the pension fund does not want to ask them).
        Optional questions are not displayed to the insured person and the answer can be omitted. The question
        configuration depends on the pension fund and on the specific policy and can be found in the
        `requiredPurchaseDetails` property.

        The pension fund may set some of the properties when the empty purchase request is queried. These values
        should be used as the initial values.
      properties:
        amount:
          type: number
          format: double
          minimum: 1
          description: |
            Answer to question 1a: Requested purchase amount in CHF.
          examples:
            - 10000.00
        hasVestedBenefits:
          type: boolean
          description: |
            Answer to question 2a: Indicates if the insured person has pillar 2 vested benefits outside the pension fund (`true`) or not (`false`)
          examples:
            - false
        hasMadeSelfEmployedContributions:
          type: boolean
          description: |
            Answer to question 3a: Indicates if the insured person has made pillar 3a contributions while being self-employed (`true`) or not (`false`)
          examples:
            - false
        selfEmployedContributionCredit:
          type: number
          format: double
          minimum: 1
          description: |
            Answer to question 3b: Balance of pillar 3a credit as of the end of last year.
          examples:
            - 35000.00
        hasNotRepaidEarlyWithdrawal:
          type: boolean
          description: |
            Answer to question 4a: Indicates if the insured person has made an early withdrawal of savings to fund the purchase of residential property and has not repaid it fully (`true`) or not (`false`).
          examples:
            - false
        hasMovedFromAbroad:
          type: boolean
          description: |
            Answer to question 5a: Indicates if the insured person has moved to Switzerland from abroad during the last 5 years (`true`) or not (`false`).
          examples:
            - false
        moveFromAbroadDate:
          $ref: '#/components/schemas/Date'
          description: |
            Answert to question 5b: Date of move from another country to Switzerland.
        hasBeenInsuredBefore:
          type: boolean
          description: |
            Answer to question 5c: Indicates if the person has been insured in the Swiss pension system before (`true`) or not (`false`).
          examples:
            - false
        firstInsuranceDate:
          $ref: '#/components/schemas/Date'
          description: |
            Answert to question 5d: First entry date into the Swiss pension system.
        isDrawingPensionBenefits:
          type: boolean
          description: |
            Answer to question 6a: Indicates if the insured person is already drawing or has ever drawn retirement benefits under another pension plan (`true`) or not (`false`).
          examples:
            - false
        isInAnotherPensionPlan:
          type: boolean
          description: |
            Answer to question 7a: Indicates if the person is insured in another pension plan (`true`) or not (`false`).
          examples:
            - false
        isFullyAbleToWork:
          type: boolean
          description: |
            Answer to question 7b: Indicates if the person is fully able to work (`true`) or not (`false`).
          examples:
            - true
        isPurchaseAfterDivorce:
          type: boolean
          description: |
            Answer to question 7c: Indicates if the purchase is to make up for the pension savings surrender due to a divorce (`true`) or not (`false`).
          examples:
            - false
        isPurchaseWithPillar3aSavings:
          type: boolean
          description: |
            Answer to question 7d: Indicates if the purchase is made with funds from a pillar 3a pension plan (`true`) or not (`false`).
          examples:
            - false
        isAddressUpToDate:
          type: boolean
          description: |
            Answer to question 8a: Indicates if the postal address is up-to-date (`true`) or not (`false`).
          examples:
            - true
        phoneContact:
          type: string
          description: |
            Answer to question 8b: Phone number to contact the insured person regarding the purchase request.
          examples:
            - 0041 79 123 45 67
        emailContact:
          type: string
          description: |
            Answer to question 8c: Email address to contact the insured person regarding the purchase request.
          examples:
            - johndoe@gmail.com

    RequiredPurchaseDetails:
      type: object
      description: |
        Provides the configuration regarding which questions should be displayed/asked and additional data required for the questions.
      properties:
        askForSelfEmployedContributionCredit:
          type: boolean
          description: Indicates if question 3b is to be asked.
          examples:
            - true
        askForHasMovedFromAbroad:
          type: boolean
          description: Indicates if question 5a is to be asked.
          examples:
            - true
        askForMoveFromAbroadDate:
          type: boolean
          description: Indicates if question 5b is to be asked.
          examples:
            - true
        askForHasBeenInsuredBefore:
          type: boolean
          description: Indicates if question 5c is to be asked.
          examples:
            - true
        askForFirstInsuranceDate:
          type: boolean
          description: Indicates if question 5d is to be asked.
          examples:
            - true
        askForIsDrawingPensionBenefits:
          type: boolean
          description: Indicates if question 6a is to be asked.
          examples:
            - true
        askFoIsInAnotherPensionPlan:
          type: boolean
          description: Indicates if question 7a is to be asked.
          examples:
            - true
        askForIsFullyAbleToWork:
          type: boolean
          description: Indicates if question 7b is to be asked.
          examples:
            - true
        askForIsPurchaseAfterDivorce:
          type: boolean
          description: Indicates if question 7c is to be asked.
          examples:
            - true
        askForIsPurchaseWithPillar3aSavings:
          type: boolean
          description: Indicates if question 7d is to be asked.
          examples:
            - true
        askForIsAddressUpToDate:
          type: boolean
          description: Indicates if question 8a (postal address is up-to-date) is to be asked.
          examples:
            - true
        postalAddress:
          type: string
          description: |
            The current postal address on file.

            The address should be formatted in a human-readable form, ready to be displayed in the question sentence.
            Street, postal code and city, country etc. should be separated with comma and space; no newlines must be used.
          examples:
            - Brandstrasse 2, 3944 Unterbäch
        askForPhoneContact:
          type: boolean
          description: Indicates if question 8b is to be asked.
          examples:
            - true
        askForEmailContact:
          type: boolean
          description: Indicates if question 8c is to be asked.
          examples:
            - true

    PaymentSchedule:
      type: object
      description: |
        Desired payment method and payment schedule.

        `eBillAccount` is required if eBill payment method is chosen
        (`paymentMethod` = `singlePaymentEBill` or `paymentMethod` = `regularPaymentEBill`)

        `paymentFrequency` and `paymentSize` are required if regular payments is chosen
        (`paymentMethod` = `regularPaymentEBill`). Otherwise, they are ignored.

        `paymentFrequency` = 1 is invalid. Instead, one of the one-time payment methods
        should be chosen and the `paymentFrequency` property omitted.
      required:
        - paymentMethod
      properties:
        paymentMethod:
          $ref: '#/components/schemas/PaymentMethod'
        paymentFrequency:
          $ref: '#/components/schemas/PaymentFrequency'
        paymentSize:
          type: number
          format: double
          description: |
            Size (in CHF) of individual regular payments.
          examples:
            - 500.00
        eBillAcount:
          type: string
          description: Email address of insured person's eBill account.
          examples:
            - johndoe@gmail.com

    PaymentInstructions:
      type: object
      description: |
        Payment instructions for to insured person to make the payment. This information will only be provided
        if the request has the state `approved` and a QR bill related payment methode has been chosen
        (`paymentMethod` = `singlePaymentQrBill` or `paymentMethod` = `irreularPaymentQrBill`).
      properties:
        qrBillText:
          type: string
          description: |
            Text that is embedded in the QR code of a QR bill. It contains the relevant payment information
            including creditor, account number and payment reference.

            See chapter 4 'Swiss QR Code database' in
            [SIX - Swiss Implementation Guidelines QR-bill (PDF, English)](https://www.paymentstandards.ch/dam/downloads/ig-qr-bill-de.pdf) or
            [SIX - Schweizer Implementation Guidelines QR-Rechnung (PDF, German)](https://www.paymentstandards.ch/dam/downloads/ig-qr-bill-de.pdf).
          examples:
            - >
                SPC
                0200
                1
                CH4431999123000889012
                S
                Max Muster & Söhne
                Musterstrasse
                123
                8000
                Seldwyla
                CH

                0.00
                CHF
                S
                Simon Muster
                Musterstrasse
                1
                8000
                Seldwyla
                CH
                QRR
                210000000003139471430009017
                DO NOT USE FOR PAYMENT
                EPD

    Instructions:
      type: array
      description: |
        The instructions are a list of sentences that inform the insured person either about the next steps in the process
        that are likely to happen, or - in particular in case of status `inputRequired` - about the steps the insured
        person should take.

        Instructions should be displayed in a bullet list, each array item becoming a list item.
      items:
        description: A single instruction, display as an item in a bullet list.
        type: string

    PaymentMethod:
      type: string
      description: |
        Request status (set and updated by pension fund):
        * `singlePaymentQrBill` - A single payment must be made using the provided payment information (account number, reference no)
        * `singlePaymentEBill` - The pension fund will send a single eBill to the insured person's eBill account
        * `regularPaymentEBill` - The pension fund will send eBills to the insured person's eBill account according to the requested installments
        * `irreularPaymentQrBill` - Many payments can be made using the provided payment information (account number, reference no)
      enum:
        - singlePaymentQrBill
        - singlePaymentEBill
        - regularPaymentEBill
        - irreularPaymentQrBill
      examples:
        - singlePaymentQrBill

    PaymentFrequency:
      type: integer
      description: |
        Number of payments per year.
        Possible values:
        * 0: One-time payment
        * 1: Annual payment
        * 2: Semi-annual payment
        * 4: Quarterly payment
        * 12: Monthly payment
      examples:
        - 0

    PurchaseRequestId:
      type: string
      pattern: '^[A-Za-z0-9_\-.~]{1,64}$'
      description: Technical ID of purchase request used in API calls.
      examples:
        - PR-4838525

    Transactions:
      type: object
      description: Retirement capital transactions.
      required:
        - transaction
        - from
        - to
      properties:
        transactions:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
          description: Chronologically sorted list of transactions.
        from:
          $ref: '#/components/schemas/Date'
          description: Start of date range (inclusive).
        to:
          $ref: '#/components/schemas/Date'
          description: End of date range (inclusive).

    Transaction:
      type: object
      description: Transaction affecting the retirement capital.
      required:
        - category
        - date
        - amount
        - reason
        - balance
      properties:
        id:
          type: string
          description: Transaction ID.
          examples:
            - TR-683463823
        category:
          type: string
          description: |
            Transaction category:
            * `carryover`: Pseudo transaction to provide the carryover from the preceding period
            * `transfer`: Transfer in and out of the fund (related to an start and end of employment)
            * `employeeContribution`: Employee contribution as part of salary payment
            * `employerContribution`: Employer contribution as part of salary payment
            * `homeOwnershipEncouragement`: Transaction related to home ownerhsip encouragement scheme
            * `voluntaryPurchase`: Transaction related to voluntary purchse of retirement benefits
            * `securityInvestment`: Transaction related to a security investment or deinvestment
            * `dividend`: Transaction related to payouts/distributions from security investments
            * `fee`: Transaction related to fees
            * `other`: Other reason for transaction not listed above
          enum:
            - carryover
            - transfer
            - employeeContribution
            - employerContribution
            - homeOwnershipEncouragement
            - voluntaryPurchase
            - securityInvestment
            - dividend
            - fee
            - other
          examples:
            - voluntaryPurchase
        date:
          $ref: '#/components/schemas/Date'
          description: Transaction date (date the transaction becomes effective financially).
        amount:
          type: number
          description: Transaction amount (in CHF, positive numbers for credits, negative numbers for debits).
          examples:
            - 10000.00
        reason:
          type: string
          description: |
            A human-readable description of the transaction reason, in the insured person's
            preferred language.
          examples:
            - Freiwilliger Einkauf
        balance:
          type: number
          format: double
          description: Retirement capital balance after transaction.
          examples:
            - 63842.50

    InterestRate:
      type: number
      format: double
      description: Common interest rate object.
      examples:
        - 3.175

    # ---- Common Error Response ----
    CommonErrorResponse:
      title: Common Error Response
      type: object
      description: Common Error Response.
      properties:
        type:
          $ref: '#/components/schemas/CommonErrorType'
        title:
          type: string
          description: The error title.
          examples:
            - This is the general problem description
        detail:
          type: string
          description: Details about the error.
          examples:
            - Detailed problem description with respect to the current request, e.g., invalid account number format
        instance:
          type: string
          description: Instance of the error.
          examples:
            - path/to/corresponding/resource

    CommonErrorType:
      title: Common Error Type
      type: string
      description: Error Types for commonErrorResponse.
      enum:
        - /problems/INVALID_PAYLOAD
        - /problems/MALFORMED_PAYLOAD
        - /problems/INVALID_TOKEN
        - /problems/EXPIRED_TOKEN
        - /problems/INSUFFICIENT_PRIVILEGES
        - /problems/NO_ACCESS_TO_RESOURCE
        - /problems/RESOURCE_DOES_NOT_EXIST
        - /problems/RESOURCE_NOT_READY
        - /problems/RESOURCE_TOO_LARGE
        - /problems/WRONG_METHOD
        - /problems/OPERATION_NOT_ALLOWED
        - /problems/TECHNICAL_ERROR
        - /problems/NOT_IMPLEMENTED
        - /problems/SERVICE_UNAVAILABLE
      examples:
        - /problems/TECHNICAL_ERROR

    # ---- Common Data Model ----
    Date:
      type: string
      description: Common date format.
      format: date
      examples:
        - 2018-04-13

  securitySchemes:
    bearerAuthentication:
      type: http
      description: Bearer access token in HTTP header.
      scheme: bearer
      bearerFormat: JWT

  # ---- Responses - Standard Errors Common Data Model ----
  responses:

    standard400:
      description: Some of the input is incomplete or invalid for starting a request.
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/CommonErrorResponse'

    standard401:
      description: Access token is missing or invalid.
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/CommonErrorResponse'

    standard404:
      description: Invalid ID / no authorization to access data.
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/CommonErrorResponse'
